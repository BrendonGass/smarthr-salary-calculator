<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Negotiator ‚Äì CTC Package Mode</title>
  <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="/static/style.css">
  <style>
    body {
      font-family: 'Ubuntu', sans-serif;
      background-color: #f4f4f4;
      font-size: 0.9rem;
    }
    
    /* Colored header band */
    .header-band {
      background: linear-gradient(135deg, #045c84 0%, #207088 50%, #f47c04 100%);
      color: white;
      padding: 1.5rem 0;
      margin-bottom: 1.5rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .header-band h2 {
      margin: 0;
      font-weight: bold;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      font-size: 1.5rem;
    }
    
    .header-band img {
      max-height: 120px;
      filter: brightness(0) invert(1);
    }
    
    .tile-section {
      border: 1px solid #ccc;
      border-radius: 8px;
      background-color: white;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    
    /* Enhanced section headers with colored bands */
    .section-header {
      background: linear-gradient(135deg, #207088 0%, #045c84 100%);
      color: white;
      padding: 0.75rem 1rem;
      margin: -1rem -1rem 1rem -1rem;
      border-radius: 8px 8px 0 0;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1rem;
      font-weight: bold;
    }
    
    .section-header img {
      width: 20px;
      filter: brightness(0) invert(1);
    }
    .grey-box {
      background-color: #eee;
      padding: 0.4rem;
      border-radius: 4px;
      font-weight: bold;
      color: #666;
      font-size: 0.85rem;
    }
    
    /* CTC Package breakdown */
    .ctc-breakdown {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border: 2px solid #dee2e6;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    
    .ctc-total {
      font-size: 1.5rem;
      font-weight: bold;
      color: #207088;
      text-align: center;
      margin-bottom: 1rem;
    }
    
    .breakdown-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid #dee2e6;
    }
    
    .breakdown-item:last-child {
      border-bottom: none;
      font-weight: bold;
      font-size: 1.1rem;
      color: #f47c04;
    }
    
    /* Dynamic item styling */
    .dynamic-item {
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      padding: 0.5rem;
      margin-bottom: 0.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.85rem;
    }
    
    .remove-btn {
      background-color: #dc3545;
      color: white;
      border: none;
      border-radius: 3px;
      padding: 0.2rem 0.4rem;
      cursor: pointer;
      font-size: 0.7rem;
    }
    
    .remove-btn:hover {
      background-color: #c82333;
    }
    
    /* Dependants field */
    .dependants-field {
      display: none;
      margin-top: 0.5rem;
      padding: 0.5rem;
      background-color: #f8f9fa;
      border-radius: 4px;
      border-left: 3px solid #207088;
      font-size: 0.85rem;
    }
    
    /* Compact form styling */
    .form-control, .form-select {
      padding: 0.375rem 0.5rem;
      font-size: 0.85rem;
    }
    
    .form-label {
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }
    
    .section-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1rem;
      font-weight: bold;
      color: #207088;
      margin-bottom: 0.5rem;
    }
    
    .net-pay-highlight {
      font-size: 1.5rem;
      font-weight: bold;
      color: #f47c04;
    }
    
    /* Age display */
    .age-display {
      background-color: #e3f2fd;
      color: #1976d2;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: bold;
      display: inline-block;
      margin-left: 0.5rem;
    }
    
    /* Package toggle */
    .package-toggle {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      margin-bottom: 0.5rem;
      font-size: 0.85rem;
    }
    
    .toggle-btn {
      padding: 0.25rem 0.5rem;
      border: 1px solid #dee2e6;
      background-color: #f8f9fa;
      cursor: pointer;
      border-radius: 4px;
      font-size: 0.8rem;
    }
    
    .toggle-btn.active {
      background-color: #207088;
      color: white;
      border-color: #207088;
    }
    
    /* Running totals */
    .running-total {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border: 2px solid #dee2e6;
      border-radius: 6px;
      padding: 0.75rem;
      margin-top: 1rem;
      text-align: center;
      font-weight: bold;
    }
    
    .running-total.earnings {
      border-color: #28a745;
      background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
      color: #155724;
    }
    
    .running-total.deductions {
      border-color: #dc3545;
      background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
      color: #721c24;
    }
    
    .running-total.employer {
      border-color: #ffc107;
      background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
      color: #856404;
    }
    
    .running-total.netpay {
      border-color: #f47c04;
      background: linear-gradient(135deg, #ffe6cc 0%, #ffd699 100%);
      color: #cc6600;
    }
    
    /* Pension calculation display */
    .pension-calc {
      background-color: #e3f2fd;
      border: 1px solid #2196f3;
      border-radius: 4px;
      padding: 0.5rem;
      margin-top: 0.5rem;
      font-size: 0.85rem;
      color: #1976d2;
      display: none;
    }
    
    /* Popup styles */
    #popup {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: url('/static/images/popup-bg.jpg') center center/cover no-repeat;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #popup::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0,0,0,0.6);
    }
    #popup-content {
      position: relative;
      z-index: 2;
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      width: 100%;
      max-width: 450px;
      text-align: center;
    }
    #popup-content img.logo {
      max-height: 140px;
      margin-bottom: 1rem;
    }
    .popup-footer {
      margin-top: 1rem;
    }
    .popup-footer img {
      width: 30px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<!-- POPUP -->
<div id="popup">
  <div id="popup-content">
    <img src="/static/images/gosmarthr-logo.png" class="logo" alt="SmartHR logo">
    <h4>Welcome to The Negotiator</h4>
    <form id="popup-form">
      <input type="text" id="popup-id" class="form-control mb-2" placeholder="ID Number" required>
      <select id="popup-mode" class="form-select mb-3">
        <option value="">Select Calculator Mode</option>
        <option value="basic">Basic Salary Calculator</option>
        <option value="ctc" selected>CTC Package Calculator</option>
        <option value="netpay">Net Pay Modeler</option>
      </select>
      <button type="submit" class="btn btn-primary w-100">Get Started</button>
    </form>
    <div class="popup-footer text-end">
      <a href="/admin"><img src="/static/images/admin-icon.png" title="Admin Login" /></a>
    </div>
  </div>
</div>

<!-- MAIN FORM -->
<div id="main-form" style="display: none;">
  <!-- Colored Header Band -->
  <div class="header-band">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-4 text-start">
          <a href="/dashboard" class="btn btn-outline-light btn-sm" style="border-radius: 20px; padding: 8px 16px; margin-right: 10px;">
            ‚Üê Back to Dashboard
          </a>
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-outline-light btn-sm" id="open-offers-btn" style="border-radius: 20px 0 0 20px; padding: 8px 16px;">
              üìÅ Open Offers
            </button>
            <button type="button" class="btn btn-outline-light btn-sm" id="completed-offers-btn" style="border-radius: 0; padding: 8px 16px; border-left: none;">
              ‚úÖ Completed
            </button>
            <button type="button" class="btn btn-outline-light btn-sm" id="new-offer-btn" style="border-radius: 0 20px 20px 0; padding: 8px 16px; border-left: none;">
              ‚ûï New
            </button>
          </div>
        </div>
        <div class="col-md-4 text-center">
          <img src="/static/images/gosmarthr-logo.png" alt="SmartHR">
          <h2>The Negotiator ‚Äì CTC Package Mode</h2>
          <div id="welcome-message" style="display: none; color: #fff; font-size: 1.1rem; margin-top: 0.5rem; font-weight: 500;">
            Welcome, <span id="welcome-name"></span>!
          </div>
        </div>
        <div class="col-md-4 text-end">
          <button type="button" class="btn btn-outline-light btn-sm" id="save-offer-btn" style="border-radius: 20px; padding: 8px 16px; margin-right: 10px;">
            üíæ Save Offer
          </button>
          <button type="button" class="btn btn-outline-light btn-sm" id="complete-offer-btn" style="border-radius: 20px; padding: 8px 16px;">
            ‚úÖ Complete
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="container mb-4">
    <!-- Personal Details -->
    <div class="tile-section">
      <div class="section-header">
        <img src="/static/images/personal-icon.png" alt="Personal">
        Personal Details
        <span class="age-display" id="age-display" style="display: none; margin-left: auto;">Age: <span id="calculated-age"></span></span>
      </div>
      <div class="row g-2 mt-1">
        <div class="col-md-4"><input type="text" class="form-control" id="name" placeholder="Full Name"></div>
        <div class="col-md-4"><input type="text" class="form-control" id="id_number" placeholder="ID Number"></div>
        <div class="col-md-4"><input type="email" class="form-control" id="email" placeholder="Email"></div>
        <div class="col-md-4"><input type="text" class="form-control" id="job_title" placeholder="Job Title"></div>
        <div class="col-md-4"><input type="text" class="form-control" id="department" placeholder="Department"></div>
      </div>
    </div>

    <!-- CTC Package Breakdown -->
    <div class="ctc-breakdown">
      <div class="ctc-total">
        <label for="ctc_input" class="form-label">Total CTC Package:</label>
        <input type="number" class="form-control form-control-lg" id="ctc_input" placeholder="Enter CTC amount" step="0.01" min="0" style="text-align: center; font-weight: bold; color: #207088;">
      </div>
      <div class="breakdown-item">
        <span>Other Allowances:</span>
        <span>R <span id="other_allowances_total">0.00</span></span>
      </div>
      <div class="breakdown-item">
        <span>Employer Contributions:</span>
        <span>R <span id="employer_total">0.00</span></span>
      </div>
      <div class="breakdown-item">
        <span>Cash Component:</span>
        <span>R <span id="cash_component">0.00</span></span>
      </div>
    </div>

    <div class="row">
      <!-- Cash Component and Earnings -->
      <div class="col-md-6">
        <div class="tile-section">
          <div class="section-header">
            <img src="/static/images/income-icon.png" alt="Earnings">
            Cash Component Breakdown
          </div>
          <div class="mb-3 p-3 border rounded bg-light">
            <label class="form-label fw-bold text-primary">Cash Component (Calculated):</label>
            <div class="form-control form-control-lg" style="text-align: center; font-weight: bold; color: #207088; background-color: #f8f9fa;">
              R <span id="cash_component_display">0.00</span>
            </div>
            <div class="mt-2 text-muted">
              <small>This is calculated as: CTC - Other Allowances - Employer Contributions (Package)</small>
            </div>
          </div>
          
          <!-- Pensionable Salary Section -->
          <div class="package-toggle">
            <span>Pensionable Salary:</span>
            <button type="button" class="toggle-btn active" data-type="percentage">%</button>
            <button type="button" class="toggle-btn" data-type="amount">R</button>
            <input type="number" class="form-control" id="pensionable_percent" placeholder="100" style="max-width: 80px;">
          </div>
          
          <div class="pension-calc" id="pension-calc">
            Calculated Amount: R <span id="pension-calc-amount">0.00</span>
          </div>
          
          <div id="earnings-list"></div>
          <div class="row g-2">
            <div class="col-6">
              <select id="earning-dropdown" class="form-select">
                <option value="">Select earning to add</option>
                <option value="Travel Allowance">Travel Allowance</option>
                <option value="Cellphone Allowance">Cellphone Allowance</option>
                <option value="Internet Allowance">Internet Allowance</option>
                <option value="Entertainment Allowance">Entertainment Allowance</option>
                <option value="Medical Allowance">Medical Allowance</option>
                <option value="Bonus">Bonus</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="col-3">
              <input type="number" class="form-control" id="earning-value" placeholder="Amount" style="display: none;">
            </div>
            <div class="col-3">
              <div class="package-toggle" style="margin: 0;">
                <span style="font-size: 0.7rem;">Package:</span>
                <button type="button" class="toggle-btn active" data-type="package" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">Yes</button>
                <button type="button" class="toggle-btn" data-type="not-package" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">No</button>
              </div>
            </div>
          </div>
          <div class="row g-2 mt-2">
            <div class="col-12">
              <button type="button" class="btn btn-success btn-sm" id="add-earning-btn" style="display: none; width: 100%; font-size: 0.8rem;">+ Add Earning</button>
            </div>
          </div>
          <small class="text-muted" style="font-size: 0.75rem; display: block; margin-top: 2px;">üí° Tip: "Package" means it's part of your CTC, "Not Package" means it's additional to your CTC</small>
          
          <!-- Running Total for Earnings -->
          <div class="running-total earnings">
            Total Cash Component: R <span id="total-earnings">0.00</span>
          </div>
        </div>

        <div class="tile-section">
          <div class="section-header">
            <img src="/static/images/deductions-icon.png" alt="Deductions">
            Deductions
          </div>
          <div class="mb-2 grey-box">PAYE: R <span id="paye_val">0.00</span></div>
          <div class="mb-2 grey-box">UIF (EE): R <span id="uif_ee_val">0.00</span></div>
          <div id="deduction-list"></div>
          <div class="row g-2">
            <div class="col-6">
              <select id="deduction-dropdown" class="form-select">
                <option value="">Select deduction</option>
                <option value="Pension/Provident/RA">Pension/Provident/RA</option>
                <option value="Medical Aid (EE)">Medical Aid (EE)</option>
                <option value="Union">Union</option>
                <option value="Personnel Club">Personnel Club</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="col-3">
              <div class="row g-1">
                <div class="col-6">
                  <button type="button" class="btn btn-sm btn-outline-secondary deduction-toggle" data-type="amount" style="width: 100%; font-size: 0.7rem;">R</button>
                </div>
                <div class="col-6">
                  <button type="button" class="btn btn-sm btn-outline-secondary deduction-toggle" data-type="percentage" style="width: 100%; font-size: 0.7rem;">%</button>
                </div>
              </div>
              <input type="number" class="form-control mt-1" id="deduction-value" placeholder="Amount" style="display: none;">
            </div>
            <div class="col-3">
              <div class="package-toggle" style="margin: 0;">
                <span style="font-size: 0.7rem;">Package:</span>
                <button type="button" class="toggle-btn active" data-type="package" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">Yes</button>
                <button type="button" class="toggle-btn" data-type="not-package" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">No</button>
              </div>
            </div>
          </div>
          
          <!-- Dependants field for Medical Aid -->
          <div class="dependants-field" id="dependants-field">
            <label for="dependants" class="form-label">Number of Dependants:</label>
            <input type="number" class="form-control" id="dependants" placeholder="0" min="0" max="10">
          </div>
          
          <!-- Add Deduction Button -->
          <div class="row g-2 mt-2">
            <div class="col-12">
              <button type="button" class="btn btn-success btn-sm" id="add-deduction-btn" style="display: none; width: 100%; font-size: 0.8rem;">+ Add Deduction</button>
            </div>
          </div>
          
          <!-- Running Total for Deductions -->
          <div class="running-total deductions">
            Total Deductions: R <span id="total-deductions">0.00</span>
          </div>
        </div>
      </div>

      <!-- Employer Contributions and Net Pay -->
      <div class="col-md-6">
        <div class="tile-section">
          <div class="section-header">
            <img src="/static/images/pension-icon.png" alt="Employer">
            Employer Contributions
          </div>
          <div class="mb-2 grey-box">UIF (ER): R <span id="uif_er_val">0.00</span></div>
          <div class="mb-2 grey-box">SDL: R <span id="sdl_val">0.00</span></div>
          <div id="employer-list"></div>
          <div class="row g-2">
            <div class="col-6">
              <select id="employer-dropdown" class="form-select">
                <option value="">Select contribution</option>
                <option value="Pension/Provident/RA">Pension/Provident/RA</option>
                <option value="Medical Aid (ER)">Medical Aid (ER)</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="col-3">
              <div class="row g-1">
                <div class="col-6">
                  <button type="button" class="btn btn-sm btn-outline-secondary employer-toggle" data-type="amount" style="width: 100%; font-size: 0.7rem;">R</button>
                </div>
                <div class="col-6">
                  <button type="button" class="btn btn-sm btn-outline-secondary employer-toggle" data-type="percentage" style="width: 100%; font-size: 0.7rem;">%</button>
                </div>
              </div>
              <input type="number" class="form-control mt-1" id="employer-value" placeholder="Amount" style="display: none;">
            </div>
            <div class="col-3">
              <div class="package-toggle" style="margin: 0;">
                <span style="font-size: 0.7rem;">Package:</span>
                <button type="button" class="toggle-btn active" data-type="package" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">Yes</button>
                <button type="button" class="toggle-btn" data-type="not-package" style="font-size: 0.7rem; padding: 0.2rem 0.4rem;">No</button>
              </div>
            </div>
          </div>
          
          <!-- Add Employer Button -->
          <div class="row g-2 mt-2">
            <div class="col-12">
              <button type="button" class="btn btn-success btn-sm" id="add-employer-btn" style="display: none; width: 100%; font-size: 0.8rem;">+ Add Employer Contribution</button>
            </div>
          </div>
          
          <!-- Running Total for Employer -->
          <div class="running-total employer">
            Total Employer: R <span id="total-employer">0.00</span>
          </div>
        </div>

        <div class="tile-section">
          <div class="section-header">
            üí∞ Net Pay
          </div>
          <div class="net-pay-highlight">R <span id="net_pay_val">0.00</span></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const popup = document.getElementById("popup");
    const popupForm = document.getElementById("popup-form");

    // Initialize variables
    let ctcTotal = 0;
    let employerContributions = 0;
    let cashComponent = 0;

    if (sessionStorage.getItem("userID") && sessionStorage.getItem("calculatorMode")) {
      popup.style.display = "none";
      document.getElementById("main-form").style.display = "block";
      document.getElementById("id_number").value = sessionStorage.getItem("userID");
      calculateAgeFromID(sessionStorage.getItem("userID"));
    }

    popupForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const id = document.getElementById("popup-id").value;
      const mode = document.getElementById("popup-mode").value;
      if (id && mode) {
        sessionStorage.setItem("userID", id);
        sessionStorage.setItem("calculatorMode", mode);
        
        // Redirect to the appropriate calculator mode
        if (mode === 'basic') {
          window.location.href = '/basic';
        } else if (mode === 'netpay') {
          window.location.href = '/netpay';
        } else {
          // CTC mode - stay on current page
          popup.style.display = "none";
          document.getElementById("main-form").style.display = "block";
          document.getElementById("id_number").value = id;
          calculateAgeFromID(id);
        }
      }
    });

    // ID Number age calculation
    document.getElementById('id_number').addEventListener('input', function() {
      if (this.value.length >= 6) {
        calculateAgeFromID(this.value);
      }
    });

    function calculateAgeFromID(idNumber) {
      if (idNumber.length >= 6) {
        const year = parseInt(idNumber.substring(0, 2));
        const month = parseInt(idNumber.substring(2, 4));
        const day = parseInt(idNumber.substring(4, 6));
        
        // Determine century (assuming 1900s for years 00-29, 2000s for 30-99)
        const fullYear = year <= 29 ? 2000 + year : 1900 + year;
        
        const birthDate = new Date(fullYear, month - 1, day);
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        
        // Adjust age if birthday hasn't occurred this year
        if (today.getMonth() < birthDate.getMonth() || 
            (today.getMonth() === birthDate.getMonth() && today.getDate() < birthDate.getDate())) {
          age--;
        }
        
        document.getElementById('calculated-age').textContent = age;
        document.getElementById('age-display').style.display = 'inline-block';
      }
    }

    // CTC Total input
    document.getElementById('ctc_input').addEventListener('input', function() {
      ctcTotal = parseFloat(this.value) || 0;
      updateBreakdown();
      updateCashComponent();
    });

    function updateBreakdown() {
      // Calculate other allowances (earnings marked as package)
      const earnings = document.querySelectorAll('#earnings-list .dynamic-item');
      let otherAllowances = 0;
      
      earnings.forEach(item => {
        const isPackage = item.querySelector('span:first-child').textContent.includes('(Package)');
        if (isPackage) {
          const amount = parseFloat(item.querySelector('span:nth-child(2)').textContent.replace('R ', '')) || 0;
          otherAllowances += amount;
        }
      });
      
      // Calculate employer contributions marked as package
      const employerItems = document.querySelectorAll('#employer-list .dynamic-item');
      let packageEmployerContributions = 0;
      
      employerItems.forEach(item => {
        const isPackage = item.querySelector('span:first-child').textContent.includes('(Package)');
        if (isPackage) {
          const amount = parseFloat(item.querySelector('span:nth-child(2)').textContent.replace('R ', '')) || 0;
          packageEmployerContributions += amount;
        }
      });
      
      // Calculate cash component: CTC - Other Allowances - Package Employer Contributions
      cashComponent = Math.max(0, ctcTotal - otherAllowances - packageEmployerContributions);
      
      // Update display
      document.getElementById('other_allowances_total').textContent = otherAllowances.toFixed(2);
      document.getElementById('employer_total').textContent = employerContributions.toFixed(2);
      document.getElementById('cash_component').textContent = cashComponent.toFixed(2);
      document.getElementById('cash_component_display').textContent = cashComponent.toFixed(2);
    }

    function updateCashComponent() {
      // Update the cash component display
      document.getElementById('cash_component_display').textContent = cashComponent.toFixed(2);
      updateTotals();
    }

    // Package toggle functionality
    document.querySelectorAll('.toggle-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const type = this.dataset.type;
        const container = this.closest('.package-toggle');
        
        // Update active button
        container.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        // Handle different toggle types
        if (type === 'percentage' || type === 'amount') {
          // Pension toggle functionality
          const input = container.querySelector('input');
          const calcDiv = document.getElementById('pension-calc');
          
          if (type === 'percentage') {
            input.placeholder = '100';
            input.setAttribute('max', '100');
            calcDiv.style.display = 'block';
            updatePensionCalculation();
          } else {
            input.placeholder = 'Amount';
            input.removeAttribute('max');
            calcDiv.style.display = 'none';
          }
        }
        // Package toggle functionality is handled separately
      });
    });

    // Package toggle functionality for earnings, deductions, and employer contributions
    document.querySelectorAll('.package-toggle .toggle-btn[data-type="package"], .package-toggle .toggle-btn[data-type="not-package"]').forEach(btn => {
      btn.addEventListener('click', function() {
        const type = this.dataset.type;
        const container = this.closest('.package-toggle');
        
        // Update active button
        container.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // Pension calculation
    document.getElementById('pensionable_percent').addEventListener('input', function() {
      updatePensionCalculation();
    });

    document.getElementById('basic_salary').addEventListener('input', function() {
      updatePensionCalculation();
      updateTotals();
    });

    function updatePensionCalculation() {
      const basicSalary = parseFloat(document.getElementById('basic_salary').value) || 0;
      const percentage = parseFloat(document.getElementById('pensionable_percent').value) || 100;
      const isPercentage = document.querySelector('.toggle-btn.active').dataset.type === 'percentage';
      
      if (isPercentage && basicSalary > 0) {
        const calculatedAmount = (basicSalary * percentage) / 100;
        document.getElementById('pension-calc-amount').textContent = calculatedAmount.toFixed(2);
      }
    }

    // Deduction toggle functionality
    document.querySelectorAll('.deduction-toggle').forEach(btn => {
      btn.addEventListener('click', function() {
        const type = this.dataset.type;
        const container = this.closest('.col-4');
        
        // Update active button
        container.querySelectorAll('.deduction-toggle').forEach(b => {
          b.classList.remove('btn-primary');
          b.classList.add('btn-outline-secondary');
        });
        this.classList.remove('btn-outline-secondary');
        this.classList.add('btn-primary');
        
        // Update input placeholder
        const input = container.querySelector('input');
        if (type === 'percentage') {
          input.placeholder = 'Percentage';
          input.setAttribute('max', '100');
        } else {
          input.placeholder = 'Amount';
          input.removeAttribute('max');
        }
      });
    });

    // Employer toggle functionality
    document.querySelectorAll('.employer-toggle').forEach(btn => {
      btn.addEventListener('click', function() {
        const type = this.dataset.type;
        const container = this.closest('.col-4');
        
        // Update active button
        container.querySelectorAll('.employer-toggle').forEach(b => {
          b.classList.remove('btn-primary');
          b.classList.add('btn-outline-secondary');
        });
        this.classList.remove('btn-outline-secondary');
        this.classList.add('btn-primary');
        
        // Update input placeholder
        const input = container.querySelector('input');
        if (type === 'percentage') {
          input.placeholder = 'Percentage';
          input.setAttribute('max', '100');
        } else {
          input.placeholder = 'Amount';
          input.removeAttribute('max');
        }
      });
    });

    // Earnings dropdown functionality
    document.getElementById('earning-dropdown').addEventListener('change', function() {
      const value = this.value;
      const valueInput = document.getElementById('earning-value');
      const addBtn = document.getElementById('add-earning-btn');
      
      if (value) {
        valueInput.style.display = 'block';
        addBtn.style.display = 'block';
        valueInput.placeholder = value === 'Other' ? 'Enter amount' : 'Amount';
        valueInput.focus();
      } else {
        valueInput.style.display = 'none';
        addBtn.style.display = 'none';
        valueInput.value = '';
      }
    });

    // Add earning when value is entered
    document.getElementById('earning-value').addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && this.value) {
        addEarning();
      }
    });

    // Add earning button
    document.getElementById('add-earning-btn').addEventListener('click', function() {
      addEarning();
    });

    // Employer dropdown functionality
    document.getElementById('employer-dropdown').addEventListener('change', function() {
      const value = this.value;
      const valueInput = document.getElementById('employer-value');
      const addBtn = document.getElementById('add-employer-btn');
      
      if (value) {
        valueInput.style.display = 'block';
        addBtn.style.display = 'block';
        valueInput.placeholder = value === 'Other' ? 'Enter amount' : 'Amount';
        valueInput.focus();
      } else {
        valueInput.style.display = 'none';
        addBtn.style.display = 'none';
        valueInput.value = '';
      }
    });

    // Add employer contribution when value is entered
    document.getElementById('employer-value').addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && this.value) {
        addEmployer();
      }
    });

    // Add employer button
    document.getElementById('add-employer-btn').addEventListener('click', function() {
      addEmployer();
    });

    // Deductions dropdown functionality
    document.getElementById('deduction-dropdown').addEventListener('change', function() {
      const value = this.value;
      const valueInput = document.getElementById('deduction-value');
      const addBtn = document.getElementById('add-deduction-btn');
      const dependantsField = document.getElementById('dependants-field');
      
      if (value) {
        valueInput.style.display = 'block';
        addBtn.style.display = 'block';
        valueInput.placeholder = value === 'Other' ? 'Enter amount' : 'Amount';
        valueInput.focus();
        
        // Show dependants field for Medical Aid
        if (value === 'Medical Aid (EE)') {
          dependantsField.style.display = 'block';
        } else {
          dependantsField.style.display = 'none';
        }
      } else {
        valueInput.style.display = 'none';
        addBtn.style.display = 'none';
        valueInput.value = '';
        dependantsField.style.display = 'none';
      }
    });

    // Add deduction when value is entered
    document.getElementById('deduction-value').addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && this.value) {
        addDeduction();
      }
    });

    // Add deduction button
    document.getElementById('add-deduction-btn').addEventListener('click', function() {
      addDeduction();
    });

    function addEarning() {
      const dropdown = document.getElementById('earning-dropdown');
      const valueInput = document.getElementById('earning-value');
      const list = document.getElementById('earnings-list');
      const packageToggle = document.querySelector('#earnings-list').closest('.tile-section').querySelector('.package-toggle .toggle-btn.active');
      const isPackage = packageToggle && packageToggle.dataset.type === 'package';
      
      if (dropdown.value && valueInput.value) {
        const item = document.createElement('div');
        item.className = 'dynamic-item';
        const packageIndicator = isPackage ? '<span style="color: #28a745; font-size: 0.7rem; margin-left: 5px;">(Package)</span>' : '<span style="color: #dc3545; font-size: 0.7rem; margin-left: 5px;">(Not Package)</span>';
        item.innerHTML = `
          <span style="flex: 1; font-weight: bold;">${dropdown.value}:${packageIndicator}</span>
          <span style="flex: 1;">R ${parseFloat(valueInput.value).toFixed(2)}</span>
          <button type="button" class="remove-btn" onclick="this.parentElement.remove(); updateTotals();">√ó</button>
        `;
        list.appendChild(item);
        
        // Reset inputs but keep dropdown visible for multiple additions
        valueInput.value = '';
        valueInput.style.display = 'none';
        document.getElementById('add-earning-btn').style.display = 'none';
        // Don't reset dropdown value - allow multiple additions
        
        updateBreakdown();
        updateTotals();
      }
    }

    function addEmployer() {
      const dropdown = document.getElementById('employer-dropdown');
      const valueInput = document.getElementById('employer-value');
      const list = document.getElementById('employer-list');
      const packageToggle = document.querySelector('#employer-list').closest('.tile-section').querySelector('.package-toggle .toggle-btn.active');
      const isPackage = packageToggle && packageToggle.dataset.type === 'package';
      
      if (dropdown.value && valueInput.value) {
        const amount = parseFloat(valueInput.value);
        employerContributions += amount;
        
        const item = document.createElement('div');
        item.className = 'dynamic-item';
        const packageIndicator = isPackage ? '<span style="color: #28a745; font-size: 0.7rem; margin-left: 5px;">(Package)</span>' : '<span style="color: #dc3545; font-size: 0.7rem; margin-left: 5px;">(Not Package)</span>';
        item.innerHTML = `
          <span style="flex: 1; font-weight: bold;">${dropdown.value}:${packageIndicator}</span>
          <span style="flex: 1;">R ${amount.toFixed(2)}</span>
          <button type="button" class="remove-btn" onclick="removeEmployer(this, ${amount})">√ó</button>
        `;
        list.appendChild(item);
        
        // Reset inputs
        dropdown.value = '';
        valueInput.value = '';
        valueInput.style.display = 'none';
        document.getElementById('add-employer-btn').style.display = 'none';
        
        updateBreakdown();
        updateTotals();
      }
    }

    function removeEmployer(button, amount) {
      employerContributions -= amount;
      button.parentElement.remove();
      updateBreakdown();
      updateTotals();
    }

    function addDeduction() {
      const dropdown = document.getElementById('deduction-dropdown');
      const valueInput = document.getElementById('deduction-value');
      const list = document.getElementById('deduction-list');
      const packageToggle = document.querySelector('#deduction-list').closest('.tile-section').querySelector('.package-toggle .toggle-btn.active');
      const isPackage = packageToggle && packageToggle.dataset.type === 'package';
      
      if (dropdown.value && valueInput.value) {
        const item = document.createElement('div');
        item.className = 'dynamic-item';
        const packageIndicator = isPackage ? '<span style="color: #28a745; font-size: 0.7rem; margin-left: 5px;">(Package)</span>' : '<span style="color: #dc3545; font-size: 0.7rem; margin-left: 5px;">(Not Package)</span>';
        item.innerHTML = `
          <span style="flex: 1; font-weight: bold;">${dropdown.value}:${packageIndicator}</span>
          <span style="flex: 1;">R ${parseFloat(valueInput.value).toFixed(2)}</span>
          <button type="button" class="remove-btn" onclick="this.parentElement.remove(); updateTotals();">√ó</button>
        `;
        list.appendChild(item);
        
        // Reset inputs
        dropdown.value = '';
        valueInput.value = '';
        valueInput.style.display = 'none';
        document.getElementById('add-deduction-btn').style.display = 'none';
        document.getElementById('dependants-field').style.display = 'none';
        
        updateBreakdown();
        updateTotals();
      }
    }

    function updateTotals() {
      // Calculate total earnings (cash component)
      const basicSalary = parseFloat(document.getElementById('basic_salary').value) || 0;
      const earnings = document.querySelectorAll('#earnings-list .dynamic-item');
      let totalEarnings = basicSalary;
      
      earnings.forEach(item => {
        const amount = parseFloat(item.querySelector('span:nth-child(2)').textContent.replace('R ', '')) || 0;
        totalEarnings += amount;
      });
      
      document.getElementById('total-earnings').textContent = totalEarnings.toFixed(2);
      
      // Calculate total deductions
      const deductions = document.querySelectorAll('#deduction-list .dynamic-item');
      let totalDeductions = 0;
      
      deductions.forEach(item => {
        const amount = parseFloat(item.querySelector('span:nth-child(2)').textContent.replace('R ', '')) || 0;
        totalDeductions += amount;
      });
      
      document.getElementById('total-deductions').textContent = totalDeductions.toFixed(2);
      
      // Calculate total employer (from breakdown)
      const employerTotal = parseFloat(document.getElementById('employer_total').textContent) || 0;
      document.getElementById('total-employer').textContent = employerTotal.toFixed(2);
      
      // Calculate net pay
      const netPay = totalEarnings - totalDeductions;
      document.getElementById('net_pay_val').textContent = netPay.toFixed(2);
    }

    // Save/Load functionality
    document.getElementById('save-offer-btn').addEventListener('click', function() {
      saveOffer();
    });

    document.getElementById('open-offers-btn').addEventListener('click', function() {
      showOpenOffersModal();
    });

    document.getElementById('completed-offers-btn').addEventListener('click', function() {
      showCompletedOffersModal();
    });

    document.getElementById('new-offer-btn').addEventListener('click', function() {
      showNewOfferPopup();
    });

    document.getElementById('complete-offer-btn').addEventListener('click', function() {
      completeOffer();
    });

    // Save offer data to localStorage
    function saveOffer() {
      const offerData = {
        // Personal details
        name: document.getElementById('name').value,
        id_number: document.getElementById('id_number').value,
        email: document.getElementById('email').value,
        job_title: document.getElementById('job_title').value,
        department: document.getElementById('department').value,
        
        // CTC and cash component
        ctc_total: document.getElementById('ctc_input').value,
        cash_component: document.getElementById('cash_component').textContent,
        basic_salary: document.getElementById('basic_salary').value,
        pensionable_percent: document.getElementById('pensionable_percent').value,
        
        // Earnings
        earnings: Array.from(document.querySelectorAll('#earnings-list .dynamic-item')).map(item => {
          const name = item.querySelector('span:first-child').textContent.split(':')[0];
          const amount = item.querySelector('span:nth-child(2)').textContent;
          const isPackage = item.querySelector('span:first-child').textContent.includes('(Package)');
          return { name, amount, isPackage };
        }),
        
        // Deductions
        deductions: Array.from(document.querySelectorAll('#deduction-list .dynamic-item')).map(item => {
          const name = item.querySelector('span:first-child').textContent.split(':')[0];
          const amount = item.querySelector('span:nth-child(2)').textContent;
          const isPackage = item.querySelector('span:first-child').textContent.includes('(Package)');
          return { name, amount, isPackage };
        }),
        
        // Employer contributions
        employer: Array.from(document.querySelectorAll('#employer-list .dynamic-item')).map(item => {
          const name = item.querySelector('span:first-child').textContent.split(':')[0];
          const amount = item.querySelector('span:nth-child(2)').textContent;
          const isPackage = item.querySelector('span:first-child').textContent.includes('(Package)');
          return { name, amount, isPackage };
        }),
        
        // Calculated values
        total_earnings: document.getElementById('total-earnings').textContent,
        total_deductions: document.getElementById('total-deductions').textContent,
        total_employer: document.getElementById('total-employer').textContent,
        net_pay: document.getElementById('net_pay_val').textContent,
        
        // Timestamp
        saved_at: new Date().toISOString()
      };
      
      const currentUser = sessionStorage.getItem('userID') || 'Admin';
      const idNumber = document.getElementById('id_number').value || 'Unknown';
      const today = new Date();
      const dateSuffix = today.getFullYear().toString().slice(-2) + 
                        (today.getMonth() + 1).toString().padStart(2, '0') + 
                        today.getDate().toString().padStart(2, '0');
      const offerKey = `offer_${currentUser}_${idNumber}_${dateSuffix}`;
      localStorage.setItem(offerKey, JSON.stringify(offerData));
      
      // Show success message
      alert('Offer saved successfully!');
    }

    // Load saved offer data
    function loadSavedOffer(offerKey) {
      const savedData = localStorage.getItem(offerKey);
      if (savedData) {
        const offerData = JSON.parse(savedData);
        
        // Show welcome message with current logged-in user
        const currentUser = sessionStorage.getItem('userID') || 'User';
        document.getElementById('welcome-name').textContent = currentUser;
        document.getElementById('welcome-message').style.display = 'block';
        
        // Load personal details
        document.getElementById('name').value = offerData.name || '';
        document.getElementById('id_number').value = offerData.id_number || '';
        document.getElementById('email').value = offerData.email || '';
        document.getElementById('job_title').value = offerData.job_title || '';
        document.getElementById('department').value = offerData.department || '';
        
        // Load CTC and cash component
        document.getElementById('ctc_input').value = offerData.ctc_total || '';
        document.getElementById('pensionable_percent').value = offerData.pensionable_percent || '100';
        
        // Trigger CTC calculation to update cash component
        const ctcEvent = new Event('input');
        document.getElementById('ctc_input').dispatchEvent(ctcEvent);
        
        // Load earnings
        const earningsList = document.getElementById('earnings-list');
        earningsList.innerHTML = '';
        if (offerData.earnings && offerData.earnings.length > 0) {
          offerData.earnings.forEach(earning => {
            const item = document.createElement('div');
            item.className = 'dynamic-item';
            const packageIndicator = earning.isPackage ? '<span style="color: #28a745; font-size: 0.7rem; margin-left: 5px;">(Package)</span>' : '<span style="color: #dc3545; font-size: 0.7rem; margin-left: 5px;">(Not Package)</span>';
            item.innerHTML = `
              <span style="flex: 1; font-weight: bold;">${earning.name}:${packageIndicator}</span>
              <span style="flex: 1;">${earning.amount}</span>
              <button type="button" class="remove-btn" onclick="this.parentElement.remove(); updateTotals();">√ó</button>
            `;
            earningsList.appendChild(item);
          });
        }
        
        // Load deductions
        const deductionsList = document.getElementById('deduction-list');
        deductionsList.innerHTML = '';
        if (offerData.deductions && offerData.deductions.length > 0) {
          offerData.deductions.forEach(deduction => {
            const item = document.createElement('div');
            item.className = 'dynamic-item';
            const packageIndicator = deduction.isPackage ? '<span style="color: #28a745; font-size: 0.7rem; margin-left: 5px;">(Package)</span>' : '<span style="color: #dc3545; font-size: 0.7rem; margin-left: 5px;">(Not Package)</span>';
            item.innerHTML = `
              <span style="flex: 1; font-weight: bold;">${deduction.name}:${packageIndicator}</span>
              <span style="flex: 1;">${deduction.amount}</span>
              <button type="button" class="remove-btn" onclick="this.parentElement.remove(); updateTotals();">√ó</button>
            `;
            deductionsList.appendChild(item);
          });
        }
        
        // Load employer contributions
        const employerList = document.getElementById('employer-list');
        employerList.innerHTML = '';
        if (offerData.employer && offerData.employer.length > 0) {
          offerData.employer.forEach(contribution => {
            const item = document.createElement('div');
            item.className = 'dynamic-item';
            const packageIndicator = contribution.isPackage ? '<span style="color: #28a745; font-size: 0.7rem; margin-left: 5px;">(Package)</span>' : '<span style="color: #dc3545; font-size: 0.7rem; margin-left: 5px;">(Not Package)</span>';
            const amount = parseFloat(contribution.amount.replace('R ', ''));
            item.innerHTML = `
              <span style="flex: 1; font-weight: bold;">${contribution.name}:${packageIndicator}</span>
              <span style="flex: 1;">${contribution.amount}</span>
              <button type="button" class="remove-btn" onclick="removeEmployer(this, ${amount})">√ó</button>
            `;
            employerList.appendChild(item);
          });
        }
        
        // Update totals
        updateTotals();
        
        // Close modal
        closeOpenOffersModal();
      }
    }

    // Modal functions
    function showOpenOffersModal() {
      document.getElementById('open-offers-modal').style.display = 'block';
      populateOffersList();
    }

    function closeOpenOffersModal() {
      document.getElementById('open-offers-modal').style.display = 'none';
    }

    function populateOffersList() {
      const offersList = document.getElementById('offers-list');
      offersList.innerHTML = '';
      
      const offers = [];
      
      // Get all saved offers from localStorage
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.startsWith('offer_')) {
          try {
            const offerData = JSON.parse(localStorage.getItem(key));
            const parts = key.split('_');
            const username = parts[1];
            const idNumber = parts.slice(2, -1).join('_'); // Remove date suffix from ID
            const dateSuffix = parts[parts.length - 1]; // Get the date suffix
            const firstName = offerData.name ? offerData.name.split(' ')[0] : '';
            const surname = offerData.name ? offerData.name.split(' ').slice(1).join(' ') : '';
            const fullName = offerData.name || 'N/A';
            offers.push({
              userId: idNumber,
              name: fullName,
              netPay: offerData.net_pay || 'R 0.00',
              savedAt: offerData.saved_at || 'Unknown',
              dateSuffix: dateSuffix,
              data: offerData,
              key: key
            });
          } catch (e) {
            console.error('Error parsing offer:', key, e);
          }
        }
      }
      
      if (offers.length === 0) {
        offersList.innerHTML = '<p class="text-muted text-center">No saved offers found.</p>';
        return;
      }
      
      // Sort by save date (newest first)
      offers.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
      
      offers.forEach(offer => {
        const offerDiv = document.createElement('div');
        offerDiv.className = 'card mb-2 offer-item';
        offerDiv.setAttribute('data-user-id', offer.userId);
        offerDiv.setAttribute('data-name', offer.name.toLowerCase());
        const displayId = offer.dateSuffix ? `${offer.userId} (${offer.dateSuffix})` : offer.userId;
        offerDiv.innerHTML = `
          <div class="card-body p-3">
            <div class="row align-items-center">
              <div class="col-md-4">
                <strong>ID: ${displayId}</strong><br>
                <small class="text-muted">${offer.name}</small>
              </div>
              <div class="col-md-3">
                <span class="text-success fw-bold">${offer.netPay}</span>
              </div>
              <div class="col-md-3">
                <small class="text-muted">${new Date(offer.savedAt).toLocaleDateString()}</small>
              </div>
              <div class="col-md-2">
                <button type="button" class="btn btn-sm btn-primary" onclick="loadOffer('${offer.key}')" style="margin-right: 5px;">
                  Load
                </button>
                <button type="button" class="btn btn-sm btn-danger" onclick="deleteOpenOffer('${offer.key}')">
                  üóëÔ∏è
                </button>
              </div>
            </div>
          </div>
        `;
        offersList.appendChild(offerDiv);
      });
    }

    function loadOffer(offerKey) {
      loadSavedOffer(offerKey);
    }

    function deleteOpenOffer(offerKey) {
      if (confirm('Are you sure you want to delete this offer?')) {
        localStorage.removeItem(offerKey);
        alert('Offer deleted successfully.');
        populateOffersList();
      }
    }

    function showNewOfferPopup() {
      // Clear current form
      clearForm();
      
      // Make form editable for new offers
      makeFormEditable();
      
      // Keep the main form visible (don't show popup)
      document.getElementById('popup').style.display = 'none';
      document.getElementById('main-form').style.display = 'block';
      
      // Clear session storage
      sessionStorage.removeItem('userID');
      sessionStorage.removeItem('calculatorMode');
      
      // Show success message
      alert('New offer form cleared! You can now enter new details.');
    }

    function clearForm() {
      // Clear personal details
      document.getElementById('name').value = '';
      document.getElementById('id_number').value = '';
      document.getElementById('email').value = '';
      document.getElementById('job_title').value = '';
      document.getElementById('department').value = '';
      
      // Clear CTC and cash component
      document.getElementById('ctc_input').value = '';
      document.getElementById('basic_salary').value = '';
      document.getElementById('pensionable_percent').value = '100';
      
      // Clear lists
      document.getElementById('earnings-list').innerHTML = '';
      document.getElementById('deduction-list').innerHTML = '';
      document.getElementById('employer-list').innerHTML = '';
      
      // Reset variables
      employerContributions = 0;
      
      // Update totals
      updateBreakdown();
      updateTotals();
    }

    function makeFormEditable() {
      // Make all form fields editable
      document.getElementById('ctc_input').readOnly = false;
      document.getElementById('basic_salary').readOnly = true; // Keep this readonly as it's derived
    }

    function completeOffer() {
      // Move offer to completed offers
      const offerData = JSON.parse(localStorage.getItem(localStorage.key(localStorage.length - 1)));
      offerData.completed_at = new Date().toISOString();
      
      const currentUser = sessionStorage.getItem('userID') || 'Admin';
      const idNumber = document.getElementById('id_number').value || 'Unknown';
      const today = new Date();
      const dateSuffix = today.getFullYear().toString().slice(-2) + 
                        (today.getMonth() + 1).toString().padStart(2, '0') + 
                        today.getDate().toString().padStart(2, '0');
      const completedKey = `completed_offer_${currentUser}_${idNumber}_${dateSuffix}`;
      localStorage.setItem(completedKey, JSON.stringify(offerData));
      
      alert('Offer completed successfully!');
    }

    function showCompletedOffersModal() {
      alert('Completed offers functionality coming soon!');
    }
  });
</script>

<!-- Modals -->
<div id="open-offers-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000;">
  <div class="modal-dialog modal-lg" style="margin: 50px auto;">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">üìÅ Open Offers</h5>
        <button type="button" class="btn-close" onclick="closeOpenOffersModal()"></button>
      </div>
      <div class="modal-body">
        <div id="offers-list"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeOpenOffersModal()">Close</button>
      </div>
    </div>
  </div>
</div>

</body>
</html> 